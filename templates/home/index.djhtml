{% extends 'base.djhtml' %}

{% block PageTitle %}- Home{% endblock %}
{% block ContentTitle %}Home{% endblock %}

{% block Content %}
<div class="row-fluid">
  <div class="alerts-container">
    <h3>STE Requests</h3>
    <div id="steRequests">
      <center>There are no requests</center>
    </div>
    <h3>PAD Requests</h3>
    <div id="padRequests">
      <center>There are no requests</center>
    </div>
    <h3>Correlator Configurarion Requests</h3>
    <div id="corrRequests">
      <center>There are no requests</center>
    </div>
    <h3>CentralLO Configuration Requests</h3>
    <div id="cloRequests">
      <center>There are no requests</center>
    </div>
    <h3>Holography Requests</h3>
    <div id="holoRequests">
      <center>There are no requests</center>
    </div>
  </div>
</div>
{% endblock %}

{% block Javascript %}
<script type="text/javascript">

function update_status(data){
  alerts = $(".alerts-container");

  /*** STE Requests ***/
  if (data.antenna != null) {
    alerts = alerts.find("#steRequests");
    if (data.is_requested || data.error) {
      if (data.error) {
        alert_type = "alert-error";
      } else {
        alert_type = "alert-success";
      }

      updateAlert(alerts,
                  alert_type,
                  data.status,
                  data.antenna,
                  true);
    } else {
      removeAlert(alerts, data.antenna);
    }

    no_request = alerts.find("center");
    if ( no_request.siblings().length > 0 ) {
      no_request.hide();
    } else {
      no_request.show();
    }
  }

  /*** PAD Requests ***/
  else {
    switch (data.resource.type) {
      case 'pad': alerts = alerts.find("#padRequests"); break;
      case 'corr': alerts = alerts.find("#corrRequests"); break;
      case 'clo': alerts = alerts.find("#cloRequests"); break;
      case 'holo': alerts = alerts.find("#holoRequests"); break;
    }
    if (data.is_requested || data.error) {
      
      if (!data.error) {
        alert_type = "alert-success";
      } else {
        alert_type = "alert-error"
      }

      updateAlert(alerts, alert_type, data.status, data.resource.id, true);
    } else {
      removeAlert(alerts, data.resource.id);
    }

    no_request = alerts.find("center");
    if ( no_request.siblings().length > 0 ) {
      no_request.hide();
    } else {
      no_request.show();
    }
  }
}

$(document).ready(function () {
  ajax(Dajax.process);
  refresh(true, ajax);
});
</script>
{% endblock %}
